/*! For license information please see editor.bundle.js.LICENSE.txt */
(()=>{"use strict";var e={38(e,t,n){n.d(t,{A:()=>l});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,".plintus-properties-panel {\n    position: absolute;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 300px;\n    background: #fff;\n    border-left: 1px solid #ddd;\n    box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);\n    z-index: 10;\n    display: flex;\n    flex-direction: column;\n    overflow-y: auto;\n}\n\n.panel-header {\n    padding: 15px;\n    border-bottom: 1px solid #ddd;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.panel-header h3 {\n    margin: 0;\n    font-size: 16px;\n    font-weight: 600;\n}\n\n.delete-button {\n    padding: 6px 12px;\n    background: #dc3545;\n    color: #fff;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n}\n\n.delete-button:hover {\n    background: #c82333;\n}\n\n.panel-content {\n    padding: 15px;\n    flex: 1;\n}\n\n.properties-elements-list {\n    margin-bottom: 20px;\n}\n\n.properties-elements-list h4 {\n    margin: 0 0 10px 0;\n    font-size: 14px;\n    font-weight: 600;\n    color: #555;\n}\n\n.properties-elements-list-items {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n}\n\n.properties-element-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 8px;\n    margin-bottom: 4px;\n    background: #f5f5f5;\n    border-radius: 4px;\n    font-size: 13px;\n}\n\n.element-type-badge {\n    background: #0073aa;\n    color: #fff;\n    padding: 2px 6px;\n    border-radius: 3px;\n    font-size: 11px;\n    font-weight: 600;\n    text-transform: uppercase;\n}\n\n.element-id {\n    color: #666;\n    font-weight: 500;\n}\n\n.element-length {\n    margin-left: auto;\n    color: #333;\n    font-weight: 600;\n}\n\n",""]);const l=a},52(e,t,n){n.d(t,{A:()=>l});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,".canvas-editor {\n    width: 100%;\n    height: 100%;\n    position: relative;\n    overflow: hidden;\n}\n\n#plintus-paperjs-canvas {\n    display: block;\n    width: 100%;\n    height: 100%;\n    /* Размеры устанавливаются через атрибуты width и height, не через CSS */\n}\n\n",""]);const l=a},56(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72(e){var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],l=0;l<e.length;l++){var c=e[l],s=r.base?c[0]+r.base:c[0],u=i[s]||0,d="".concat(s," ").concat(u);i[s]=u+1;var f=n(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)t[f].references++,t[f].updater(p);else{var m=o(p,r);r.byIndex=l,t.splice(l,0,{identifier:d,updater:m,references:1})}a.push(d)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var l=n(i[a]);t[l].references--}for(var c=r(e,o),s=0;s<i.length;s++){var u=n(i[s]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},162(e,t,n){var r=n(594),o=n(888),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=o.useSyncExternalStore,l=r.useRef,c=r.useEffect,s=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var d=l(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=s(function(){function e(e){if(!c){if(c=!0,a=e,e=r(e),void 0!==o&&f.hasValue){var t=f.value;if(o(t,e))return l=t}return l=e}if(t=l,i(a,e))return t;var n=r(e);return void 0!==o&&o(t,n)?(a=e,t):(a=e,l=n)}var a,l,c=!1,s=void 0===n?null:n;return[function(){return e(t())},null===s?void 0:function(){return e(s())}]},[t,n,r,o]);var p=a(e,d[0],d[1]);return c(function(){f.hasValue=!0,f.value=p},[p]),u(p),p}},206(e){e.exports=ReactDOM},242(e,t,n){e.exports=n(162)},314(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var l=0;l<this.length;l++){var c=this[l][0];null!=c&&(a[c]=!0)}for(var s=0;s<e.length;s++){var u=[].concat(e[s]);r&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},338(e,t,n){var r=n(206);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},493(e,t,n){var r=n(594),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useState,a=r.useEffect,l=r.useLayoutEffect,c=r.useDebugValue;function s(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),o=r[0].inst,u=r[1];return l(function(){o.value=n,o.getSnapshot=t,s(o)&&u({inst:o})},[e,n,t]),a(function(){return s(o)&&u({inst:o}),e(function(){s(o)&&u({inst:o})})},[e]),c(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},540(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},594(e){e.exports=React},601(e){e.exports=function(e){return e[1]}},659(e){var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},888(e,t,n){e.exports=n(493)},912(e,t,n){n.d(t,{A:()=>l});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,".plintus-editor {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    background: #f5f5f5;\n}\n\n.plintus-editor-content {\n    flex: 1;\n    position: relative;\n    overflow: hidden;\n    width: 100%;\n    height: 100%;\n}\n\n.plintus-editor-canvas-wrapper {\n    width: 100%;\n    height: 100%;\n    position: relative;\n}\n\n",""]);const l=a},925(e,t,n){n.d(t,{A:()=>l});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,".plintus-toolbar {\n    display: flex;\n    align-items: center;\n    padding: 10px;\n    background: #fff;\n    border-bottom: 1px solid #ddd;\n    justify-content: space-between;\n}\n\n.plintus-toolbar-section {\n    display: flex;\n    gap: 0;\n    align-items: center;\n}\n\n.plintus-toolbar-section-right {\n    margin-left: auto;\n}\n\n.plintus-tool-button {\n    width: 36px;\n    height: 36px;\n    border: 1px solid #ddd;\n    background: #fff;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0;\n    margin: 0;\n    transition: all 0.2s;\n}\n\n.plintus-tool-button:hover {\n    background: #f0f0f0;\n    border-color: #0073aa;\n}\n\n.plintus-tool-button.active {\n    background: #0073aa;\n    color: #fff;\n    border-color: #0073aa;\n}\n\n.plintus-toolbar button {\n    width: 36px;\n    height: 36px;\n    border: 1px solid #ddd;\n    background: #fff;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 0;\n    margin: 0;\n    transition: all 0.2s;\n}\n\n.plintus-toolbar button:hover {\n    background: #f0f0f0;\n    border-color: #0073aa;\n}\n\n.plintus-toolbar button.active {\n    background: #0073aa;\n    color: #fff;\n    border-color: #0073aa;\n}\n\n.plintus-toolbar button i {\n    font-size: 18px;\n}\n\n",""]);const l=a}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var r=n(594),o=n.n(r),i=n(338);const a=e=>{let t;const n=new Set,r=(e,r)=>{const o="function"==typeof e?e(t):e;if(!Object.is(o,t)){const e=t;t=(null!=r?r:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,i={setState:r,getState:o,getInitialState:()=>a,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{"production"!=={NODE_ENV:"production"}.MODE&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},a=t=e(r,o,i);return i};var l=n(242);const{useDebugValue:c}=r,{useSyncExternalStoreWithSelector:s}=l;let u=!1;const d=e=>e,f=e=>{"production"!=={NODE_ENV:"production"}.MODE&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?a(e):a)(e):e,n=(e,n)=>function(e,t=d,n){"production"!=={NODE_ENV:"production"}.MODE&&n&&!u&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),u=!0);const r=s(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return c(r),r}(t,e,n);return Object.assign(n,t),n};function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach(function(t){v(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t,n){return(t=function(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var g,w=(g=function(e,t){return{elements:[],selectedElements:[],selectedTool:"select",grid:{stepMM:1,snap:!0,visible:!0,showMajorLines:!1},dimensionsVisible:!0,viewbox:{x:0,y:0,width:800,height:400},isDrawing:!1,currentLineStart:null,setSelectedTool:function(t){return e({selectedTool:t,selectedElements:[]})},addElement:function(t){return e(function(e){return{elements:[].concat(y(e.elements),[h(h({},t),{},{id:"element-".concat(Date.now(),"-").concat(Math.random())})])}})},updateElement:function(t,n){return e(function(e){return{elements:e.elements.map(function(e){return e.id===t?h(h({},e),n):e})}})},deleteElement:function(t){return e(function(e){return{elements:e.elements.filter(function(e){return e.id!==t}),selectedElements:e.selectedElements.filter(function(e){return e.id!==t})}})},deleteSelectedElements:function(){return e(function(e){var t=new Set(e.selectedElements.map(function(e){return e.id}));return{elements:e.elements.filter(function(e){return!t.has(e.id)}),selectedElements:[]}})},selectElement:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e(function(e){return t?n?e.selectedElements.some(function(e){return e.id===t.id})?{selectedElements:e.selectedElements.filter(function(e){return e.id!==t.id})}:{selectedElements:[].concat(y(e.selectedElements),[t])}:{selectedElements:[t]}:{selectedElements:[]}})},loadProfile:function(t){return e({elements:t.elements||[],grid:t.grid||{stepMM:1,snap:!0,visible:!0,showMajorLines:!1},viewbox:t.viewbox||{x:0,y:0,width:800,height:400}})},setCurrentLineStart:function(t){return e({currentLineStart:t})},setIsDrawing:function(t){return e({isDrawing:t})},toggleDimensionsVisible:function(){return e(function(e){return{dimensionsVisible:!e.dimensionsVisible}})},toggleMajorLines:function(){return e(function(e){return{grid:h(h({},e.grid),{},{showMajorLines:!e.grid.showMajorLines})}})}}})?f(g):f;function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach(function(t){j(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function j(e,t,n){return(t=function(e){var t=function(e){if("object"!=E(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==E(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function P(e){return 3.779527559*e}function O(e){var t=e/3.779527559;return"".concat(Math.round(10*t)/10," mm")}function A(e,t){return Math.round(e/t)*t}function k(e,t){return{x:A(e.x,t),y:A(e.y,t)}}function N(e,t){return Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?{x:t.x,y:e.y}:{x:e.x,y:t.y}}function I(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=n.x-t.x,i=n.y-t.y,a=Math.sqrt(o*o+i*i);if(0===a)return!1;var l=Math.max(0,Math.min(1,((e.x-t.x)*o+(e.y-t.y)*i)/(a*a))),c=t.x+l*o,s=t.y+l*i;return Math.sqrt(Math.pow(e.x-c,2)+Math.pow(e.y-s,2))<r}function T(e){var t=e.end.x-e.start.x,n=e.end.y-e.start.y,r=Math.sqrt(t*t+n*n);return 0===r?{x:0,y:0}:{x:t/r,y:n/r}}var C=n(72),D=n.n(C),L=n(825),R=n.n(L),z=n(659),V=n.n(z),W=n(56),_=n.n(W),F=n(540),q=n.n(F),G=n(113),U=n.n(G),H=n(52),B={};function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return X(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}B.styleTagTransform=U(),B.setAttributes=_(),B.insert=V().bind(null,"head"),B.domAPI=R(),B.insertStyleElement=q(),D()(H.A,B),H.A&&H.A.locals&&H.A.locals;const $=function(){var e=(0,r.useRef)(null),t=(0,r.useRef)(null),n=(0,r.useRef)(null),i=J((0,r.useState)(null),2),a=i[0],l=i[1],c=J((0,r.useState)({width:800,height:400}),2),s=c[0],u=c[1],d=w(),f=d.elements,p=d.selectedElements,m=d.selectedTool,h=d.grid,v=d.dimensionsVisible,y=d.currentLineStart,b=d.isDrawing,g=d.setCurrentLineStart,E=d.setIsDrawing,x=d.addElement,j=d.deleteElement,A=d.selectElement,C=d.deleteSelectedElements,D=P(h.stepMM),L=w(function(e){return e.viewbox});(0,r.useEffect)(function(){var e=function(){if(t.current){var e=t.current.getBoundingClientRect();u({width:e.width,height:e.height})}};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]),(0,r.useEffect)(function(){if(e.current){if("undefined"==typeof paper){var t=setInterval(function(){"undefined"!=typeof paper&&(clearInterval(t),r())},100);return function(){return clearInterval(t)}}return r(),function(){n.current&&n.current.remove()}}function r(){if(e.current){var t=e.current,r=s.width||L.width,o=s.height||L.height;t.width=r,t.height=o;var i=new paper.PaperScope;i.setup(t),n.current=i,l(i.project)}}},[]),(0,r.useEffect)(function(){if(e.current&&n.current){var t=e.current,r=s.width||L.width,o=s.height||L.height;if(t.width!==r||t.height!==o){t.width=r,t.height=o;var i=n.current;i.activate(),i.view.viewSize=new paper.Size(r,o),i.view.draw()}}},[s.width,s.height,L.width,L.height]),(0,r.useEffect)(function(){if(a&&n.current){var e=n.current;e.activate(),e.project.clear(),h.visible&&R(e,D,h.showMajorLines),f.forEach(function(t){var n=p.some(function(e){return e.id===t.id});"line"===t.type?z(e,t,n):"arc"===t.type&&V(e,t,n)}),e.view.draw()}},[f,p,h,v,a,D]),(0,r.useEffect)(function(){if(a&&n.current){var e=n.current;e.activate();var t=new paper.Tool;return t.onMouseDown=function(e){var t={x:e.point.x,y:e.point.y},n=k(t,D);if("line"===m)if(y){var r=k(N(y,n),D);x({type:"line",start:y,end:r,length:M(y,r)}),g(r),E(!0)}else g(n),E(!0);else if("select"===m){var o=f.find(function(e){if("line"===e.type)return I(t,e.start,e.end,10);if("arc"===e.type){var n=M(t,e.center);return Math.abs(n-e.radius)<10}return!1});o?A(o,!0):A(null)}else if("delete"===m){var i=f.find(function(e){if("line"===e.type)return I(t,e.start,e.end,10);if("arc"===e.type){var n=M(t,e.center);return Math.abs(n-e.radius)<10}return!1});i?j(i.id):p.length>0&&C()}else if("arc"===m){var a=f.find(function(e){return"line"===e.type&&I(t,e.start,e.end,10)});a?(p.some(function(e){return e.id===a.id})||p.length<2)&&A(a,!0):A(null)}},t.onMouseMove=function(t){if("line"===m&&y){E(!0),e.project.clear(),h.visible&&R(e,D,h.showMajorLines),f.forEach(function(t){var n=p.some(function(e){return e.id===t.id});"line"===t.type?z(e,t,n):"arc"===t.type&&V(e,t,n)});var n=k({x:t.point.x,y:t.point.y},D),r=k(N(y,n),D),o=(new paper.Path.Line({from:[y.x,y.y],to:[r.x,r.y],strokeColor:"#999",strokeWidth:2}),O(M(y,r))),i=(y.x+r.x)/2,a=(y.y+r.y)/2;new paper.PointText({point:[i,a-15],content:o,fillColor:"#666",fontSize:11}),e.view.draw()}},t.activate(),function(){t.remove()}}},[m,y,b,f,p,D,a,h,v,x,A,j,C,E,g]),(0,r.useEffect)(function(){var e=function(e){"Escape"===e.key&&b&&(g(null),E(!1))};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}},[b]);var R=function(e,t,n){var r=e.view,o=r.viewSize.width||s.width||L.width,i=r.viewSize.height||s.height||L.height,a=new paper.Layer;a.name="grid";for(var l=0;l<=o;l+=t){var c=new paper.Path.Line({from:[l,0],to:[l,i],strokeColor:"#e0e0e0",strokeWidth:.5});a.addChild(c)}for(var u=0;u<=i;u+=t){var d=new paper.Path.Line({from:[0,u],to:[o,u],strokeColor:"#e0e0e0",strokeWidth:.5});a.addChild(d)}if(n){for(var f=P(10),p=0;p<=o;p+=f){var m=new paper.Path.Line({from:[p,0],to:[p,i],strokeColor:"#999",strokeWidth:1});a.addChild(m)}for(var h=0;h<=i;h+=f){var v=new paper.Path.Line({from:[0,h],to:[o,h],strokeColor:"#999",strokeWidth:1});a.addChild(v)}}a.locked=!0},z=function(e,t,n){new paper.Path.Line({from:[t.start.x,t.start.y],to:[t.end.x,t.end.y],strokeColor:n?"#0073aa":"#000",strokeWidth:n?3:2}).data={elementId:t.id,type:"line"},v&&W(e,t,n)},V=function(e,t,n){var r=new paper.Point(t.center.x,t.center.y),o=t.radius,i=t.startAngle||0,a=t.angle||90,l=i*Math.PI/180,c=l+a*Math.PI/180,s=new paper.Point(r.x+o*Math.cos(l),r.y+o*Math.sin(l)),u=new paper.Point(r.x+o*Math.cos(c),r.y+o*Math.sin(c)),d=l+a*Math.PI/360,f=new paper.Point(r.x+o*Math.cos(d),r.y+o*Math.sin(d)),p=new paper.Path.Arc({from:s,through:f,to:u});p.strokeColor=n?"#0073aa":"#000",p.strokeWidth=n?3:2,p.data={elementId:t.id,type:"arc"}},W=function(e,t,n){if("line"===t.type){var r=(t.start.x+t.end.x)/2,o=(t.start.y+t.end.y)/2,i=45*Math.PI/180,a=r,l=o,c=r+15*Math.cos(i),s=o-15*Math.sin(i),u=c,d=s,f=c+40,p=s,m=u+20,h=d-12,v=O(t.length||M(t.start,t.end)),y=n?"#0073aa":"#666";new paper.Path.Line({from:[a,l],to:[c,s],strokeColor:y,strokeWidth:1}),new paper.Path.Line({from:[u,d],to:[f,p],strokeColor:y,strokeWidth:1}),new paper.PointText({point:[m-25,h],content:v,fillColor:y,fontSize:11})}};(0,r.useEffect)(function(){if("arc"===m&&2===p.length){var e=p[0],t=p[1];"line"===e.type&&"line"===t.type&&_(e,t)}},[m,p]);var _=function(e,t){var n=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=[{point:e.start,line1End:!0,line2End:!1},{point:e.end,line1End:!0,line2End:!1},{point:t.start,line1End:!1,line2End:!0},{point:t.end,line1End:!1,line2End:!0}],o=0;o<r.length;o++)for(var i=o+1;i<r.length;i++)if(M(r[o].point,r[i].point)<n)return S(S({},r[o].point),{},{line1End:r[o].line1End||r[i].line1End,line2End:r[o].line2End||r[i].line2End});return null}(e,t,10);if(n){var r=P(5),o=n.line1End?e.start:e.end,i=n.line2End?t.start:t.end,a=T({start:n,end:o}),l=T({start:n,end:i}),c=Math.atan2(a.y,a.x)*(180/Math.PI),s=Math.atan2(l.y,l.x)*(180/Math.PI),u={x:n.x+a.x*r,y:n.y+a.y*r},d={x:n.x+l.x*r,y:n.y+l.y*r},f=(c+s)/2*Math.PI/180,p=Math.cos(f),m=Math.sin(f),h=Math.abs(s-c);h>180&&(h=360-h);var v=h*Math.PI/180,y=r/Math.sin(v/2),b={x:n.x+p*y,y:n.y+m*y},g={type:"line",start:o,end:u,length:M(o,u)},w={type:"line",start:d,end:i,length:M(d,i)},E=v,O=Math.atan2(u.y-b.y,u.x-b.x)*(180/Math.PI);O>180&&(O-=360),O<-180&&(O+=360);var k=E*(180/Math.PI),N={type:"arc",center:b,radius:r,startAngle:O,endAngle:O+k,angle:k};j(e.id),j(t.id),x(g),x(w),x(N),A(null)}};return o().createElement("div",{ref:t,className:"canvas-editor"},o().createElement("canvas",{ref:e,id:"plintus-paperjs-canvas",style:{width:"100%",height:"100%",display:"block"}}))};var K=n(925),Q={};Q.styleTagTransform=U(),Q.setAttributes=_(),Q.insert=V().bind(null,"head"),Q.domAPI=R(),Q.insertStyleElement=q(),D()(K.A,Q),K.A&&K.A.locals&&K.A.locals;const Y=function(e){var t=e.tool,n=e.isActive,r=e.onClick;return o().createElement("button",{type:"button",className:"plintus-tool-button ".concat(n?"active":""),onClick:r,title:t.label},o().createElement("i",{className:"uil ".concat(t.icon)}))},Z=function(){var e=w(),t=e.selectedTool,n=e.setSelectedTool,r=e.grid,i=e.toggleMajorLines,a=e.dimensionsVisible,l=e.toggleDimensionsVisible;return o().createElement("div",{className:"plintus-toolbar"},o().createElement("div",{className:"plintus-toolbar-section"},[{id:"select",label:"Select",icon:"uil-vector-square"},{id:"line",label:"Line",icon:"uil-edit-alt"},{id:"arc",label:"Arc",icon:"uil-circle"},{id:"delete",label:"Delete",icon:"uil-trash-alt"}].map(function(e){return o().createElement(Y,{key:e.id,tool:e,isActive:t===e.id,onClick:function(){return n(e.id)}})})),o().createElement("div",{className:"plintus-toolbar-section plintus-toolbar-section-right"},o().createElement("button",{type:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),i()},className:r.showMajorLines?"active":"",title:"Show/Hide Major Grid Lines (10mm)"},o().createElement("i",{className:"uil uil-grids"})),o().createElement("button",{type:"button",onClick:function(e){e.preventDefault(),e.stopPropagation(),l()},className:a?"active":"",title:"Show/Hide Dimensions"},o().createElement("i",{className:"uil uil-ruler"}))))},ee=function(e){var t=e.elements,n=O(t.reduce(function(e,t){return t.start&&t.end?e+M(t.start,t.end):t.length?e+t.length:e},0));return o().createElement("div",{className:"line-properties"},o().createElement("h4",null,"Line Properties"),t.length>1&&o().createElement("p",{className:"line-count"},"Lines: ",t.length),o().createElement("div",{className:"property-item"},o().createElement("label",null,"Length:"),o().createElement("span",{className:"property-value"},n)))},te=function(e){var t=e.element,n=(w().updateElement,t.radius||0),r=t.angle||90,i=O(n*(r*Math.PI/180));return o().createElement("div",{className:"arc-properties"},o().createElement("h4",null,"Arc Properties"),o().createElement("div",{className:"property-item"},o().createElement("label",null,"Radius:"),o().createElement("span",{className:"property-value"},Math.round(n),"px")),o().createElement("div",{className:"property-item"},o().createElement("label",null,"Angle:"),o().createElement("span",{className:"property-value"},Math.round(r),"°")),o().createElement("div",{className:"property-item"},o().createElement("label",null,"Length:"),o().createElement("span",{className:"property-value"},i)))};var ne=n(38),re={};re.styleTagTransform=U(),re.setAttributes=_(),re.insert=V().bind(null,"head"),re.domAPI=R(),re.insertStyleElement=q(),D()(ne.A,re),ne.A&&ne.A.locals&&ne.A.locals;const oe=function(e){var t=e.elements,n=w().deleteSelectedElements,r=t.filter(function(e){return"line"===e.type}),i=t.filter(function(e){return"arc"===e.type});return o().createElement("div",{className:"plintus-properties-panel"},o().createElement("div",{className:"panel-header"},o().createElement("h3",null,0===t.length?"Properties":"Properties (".concat(t.length," selected)")),t.length>0&&o().createElement("button",{onClick:function(){n()},className:"delete-button"},"Delete")),o().createElement("div",{className:"panel-content"},t.length>0&&o().createElement("div",{className:"properties-elements-list"},o().createElement("h4",null,"Selected Elements:"),o().createElement("ul",{className:"properties-elements-list-items"},t.map(function(e,t){var n=function(e){return"line"===e.type?e.start&&e.end?M(e.start,e.end):e.length?e.length:0:"arc"===e.type?(e.radius||0)*((e.angle||90)*Math.PI/180):0}(e),r=O(n);return o().createElement("li",{key:e.id,className:"properties-element-item"},o().createElement("span",{className:"element-type-badge"},e.type),o().createElement("span",{className:"element-id"},"#",t+1),o().createElement("span",{className:"element-length"},r))}))),r.length>0&&o().createElement(ee,{elements:r}),1===i.length&&o().createElement(te,{element:i[0]})))};var ie,ae;function le(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return ce(s,"_invoke",function(n,r,o){var i,l,c,s=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,l=0,c=e,f.n=n,a}};function p(n,r){for(l=n,c=r,t=0;!d&&s&&!o&&t<u.length;t++){var o,i=u[t],p=f.p,m=i[2];n>3?(o=m===r)&&(c=i[(l=i[4])?5:(l=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(l=0,f.v=r,f.n=i[1]):p<m&&(o=n<3||i[0]>r||r>m)&&(i[4]=n,i[5]=r,f.n=m,l=0))}if(o||n>1)return a;throw d=!0,r}return function(o,u,m){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,m),l=u,c=m;(t=l<2?e:c)||!d;){i||(l?l<3?(l>1&&(f.n=-1),p(l,c)):f.n=c:f.v=c);try{if(s=2,i){if(l||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=i.return)&&t.call(i),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);i=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==a)break}catch(t){i=e,l=1,c=t}finally{s=1}}return{value:t,done:d}}}(n,o,i),!0),s}var a={};function l(){}function c(){}function s(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(ce(t={},r,function(){return this}),t),d=s.prototype=l.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,ce(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=s,ce(d,"constructor",s),ce(s,"constructor",c),c.displayName="GeneratorFunction",ce(s,o,"GeneratorFunction"),ce(d),ce(d,o,"Generator"),ce(d,r,function(){return this}),ce(d,"toString",function(){return"[object Generator]"}),(le=function(){return{w:i,m:f}})()}function ce(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ce=function(e,t,n,r){function i(t,n){ce(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},ce(e,t,n,r)}function se(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function ue(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){se(i,r,o,a,l,"next",e)}function l(e){se(i,r,o,a,l,"throw",e)}a(void 0)})}}var de=(null===(ie=window.plintusEditor)||void 0===ie?void 0:ie.apiUrl)||"/wp-json/plintus-paperjs/v1/",fe=(null===(ae=window.plintusEditor)||void 0===ae?void 0:ae.nonce)||"";function pe(){return(pe=ue(le().m(function e(t){var n,r;return le().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("".concat(de,"profiles/").concat(t,"/data"),{method:"GET",headers:{"X-WP-Nonce":fe}});case 1:if((n=e.v).ok){e.n=2;break}throw new Error("Failed to load profile data");case 2:return e.n=3,n.json();case 3:return e.a(2,e.v);case 4:return e.p=4,r=e.v,console.error("Error loading profile data:",r),e.a(2,null)}},e,null,[[0,4]])}))).apply(this,arguments)}function me(){return(me=ue(le().m(function e(t,n){var r,o;return le().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,fetch("".concat(de,"profiles/").concat(t,"/data"),{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":fe},body:JSON.stringify({data:n})});case 1:if((r=e.v).ok){e.n=2;break}throw new Error("Failed to save profile data");case 2:return e.n=3,r.json();case 3:return e.a(2,e.v);case 4:return e.p=4,o=e.v,console.error("Error saving profile data:",o),e.a(2,null)}},e,null,[[0,4]])}))).apply(this,arguments)}var he=n(912),ve={};ve.styleTagTransform=U(),ve.setAttributes=_(),ve.insert=V().bind(null,"head"),ve.domAPI=R(),ve.insertStyleElement=q(),D()(he.A,ve),he.A&&he.A.locals&&he.A.locals;const ye=function(){var e,t=w(),n=t.selectedElements,i=t.loadProfile,a=null===(e=window.plintusEditor)||void 0===e?void 0:e.profileId;return(0,r.useEffect)(function(){a&&function(e){return pe.apply(this,arguments)}(a).then(function(e){e&&e.data&&i(e.data)})},[a,i]),(0,r.useEffect)(function(){var e=setInterval(function(){var e=w.getState(),t=e.elements,n=e.grid,r=e.viewbox;a&&t.length>=0&&function(e,t){me.apply(this,arguments)}(a,{elements:t,grid:n,viewbox:r})},5e3);return function(){return clearInterval(e)}},[a]),o().createElement("div",{className:"plintus-editor"},o().createElement(Z,null),o().createElement("div",{className:"plintus-editor-content"},o().createElement("div",{className:"plintus-editor-canvas-wrapper"},o().createElement($,null)),n.length>0&&o().createElement(oe,{elements:n})))};var be=document.getElementById("plintus-profile-editor-paperjs-root");if(be)try{i.createRoot(be).render(o().createElement(ye,null))}catch(e){console.error("Error rendering React app:",e)}})();